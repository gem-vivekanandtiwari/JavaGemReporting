<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

</head>
<style>
        body{
           background: #fafbff;
           transform: scale(0.9);
           transform-origin: top center;
        }

        #heading{
            font-family: 'Poppins', sans-serif;
            font-style: normal;
            font-weight: 600;
            font-size: 32px;
            line-height: 48px;
            /* identical to box height */

            text-align: center;
            letter-spacing: 0.01em;
            }

        .nav-pills.pygem .nav-link.active{
            background: rgba(33, 98, 132, 1);
            border-radius: 5px;
            color: white !important;
        }

        .nav-pills.pygem .nav-link{
            color:rgba(33, 98, 132, 1)
        }
        .nav-pills.javgem .nav-link.active{
            background: rgba(48, 122, 100);
            border-radius: 5px;
            color: white !important;
        }
        
        .nav-pills.javgem .nav-link{
            color:rgba(48, 122, 100)
        }
        .tableHeading{
            font-family: 'Poppins', sans-serif;
font-style: normal;
font-weight: 600;
font-size: 18px;
line-height: 27px;
letter-spacing: 0.01em;
font-weight: bold;
float: left;
        }
        .accordHeading{
            font-family: 'Poppins', sans-serif;
font-style: normal;
font-weight: 600;
font-size: 24px;
line-height: 27px;
letter-spacing: 0.01em;
font-weight: bold;
        }
        .title-card{
font-family: 'Poppins', sans-serif;
font-style: normal;
font-weight: 500;
font-size: 16px;
line-height: 24px;
float: left;
        }
        .text-card{
font-family: 'Poppins', sans-serif;
font-style: normal;
font-weight: 600;
font-size: 24px;
line-height: 36px;
float: left;
        }
        table{
          font-size:13px !important;
      }
      .passTest{
          color: #2CAE21!important;
          border-radius: 5px;
      }
      .failTest{
          color: #EA3E3E !important;
          border-radius: 5px;
      }
      .warnTest{
          color:  #FF6C37 !important;
          border-radius: 5px;
      }
      .infoTest{
          color:  #F3BB2A !important;
          border-radius: 5px;
      }
      .incompleteTest{
          color:  #F25C5C !important;
          border-radius: 5px;
      }
      .othersTest{
          color:  #9E9E9E !important;
          border-radius: 5px;
      }
      /* a{
          color: white !important
      } */
      .head{
    background-color:#375A64;
    color: white;
}
.statusColorPass{
    background-color:#2CAE21 !important;
    color: white !important;
    padding: 5%;
    border-radius: 5px;
    text-align: center
}
.statusColorInfo{
    background-color:#F3BB2A !important;
    color: white !important;
    padding: 5%;
    border-radius: 5px;
    text-align: center;
}
.statusColorFail{
    background-color:#EA3E3E !important;
    color: white !important;
    padding: 5%;
    border-radius: 5px;
    text-align: center;
}

.statusColorWarn{
    background-color:#FF6C37 !important;
    color: white !important;
    padding: 5%;
    border-radius: 5px;
    text-align: center;
}
.statusColorIncomplete{
    background-color:#F25C5C !important;
    color: white !important;
    padding: 5%;
    border-radius: 5px;
    text-align: center;
}
.statusColorOthers{
    background-color:#9E9E9E !important;
    color: white !important;
    padding: 5%;
    border-radius: 5px;
    text-align: center;
}
.hiddenRow{
    padding: 0px !important;
}



</style>
<body onload="constructPage()">
<div class="container-fluid">
    <div class="mt-3 text-center">
        <div>

            <h4 class="my-4" id="heading"><b><span id="productType"></span> AUTOMATED TEST EXECUTION REPORT</b></h4>
            <div class="ml-5 mt-3">
                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item mr-1" role="presentation">
                        <button class="btn nav-link active" id="pills-overview-tab" data-toggle="pill"
                                data-target="#pills-overview" type="button" role="tab" aria-controls="pills-home"
                                aria-selected="true" onclick="showFilter('overview')">Overview
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="btn nav-link" id="pills-testcase-tab" data-toggle="pill"
                                data-target="#pills-testcase" type="button" role="tab" aria-controls="pills-profile"
                                aria-selected="false" onclick="showFilter('testcase')">Testcase Details
                        </button>
                    </li>
                    <li id="filters" class="nav-item ml-auto" style="float:right;display:none;">
                        <button class="btn"
                                style="background:white;border-radius: 5px !important; box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.05);"
                                onclick="showFilterCards('show')">
                            <i class=" fa fa-filter"></i> Filters
                        </button>
                    </li>
                </ul>
            </div>
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active overview" id="pills-overview" role="tabpanel"
                     aria-labelledby="pills-overview-tab">


                </div>
                <div class="tab-pane fade" id="pills-testcase" role="tabpanel" aria-labelledby="pills-testcase-tab">
                    <div class="mt-3 ml-5 mr-1">
                        <div class="card pt-3 pb-3" id="filtercard"
                             style="display:none;box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.05); border-radius:4px !important">

                            <div class="d-flex mx-4 mb-3">
                                <span id="filterHeading" class="tableHeading">Filters</span>
                                <span class="ml-auto"><i class="fa fa-times" style="cursor: pointer;" aria-hidden="true"
                                                         onclick="showFilterCards('close')"></i>
                                </span>
                            </div>
                            <div class="d-flex ml-4">
                                <div class="">

                                    <input class="form-control search-key" type="text" id="name"
                                           placeholder="Search by Tc_name" style="width:270px">

                                </div>
                                <div class="col-sm-2 col-md-2 col-lg-2">
                                    <select class="custom-select search-key" style="width:270px" id="status"></select>
                                </div>
                            </div>
                            <div class="mx-4 mt-3">
                                <div class="d-flex">
                                    <!-- <button class="btn" id="applyfilter" onclick="applyfilter()" style="display:block; border-radius:5px !important; color: white !important">Apply Filters</button> -->
                                    <button class="btn ml-2" id="clear" onclick="myFunction()"
                                            style="display:block;  border-radius:5px !important; color:white !important">
                                        Clear
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


</body>
<script>
        theme={
        
        };
        pygemThemes={
            "0":"rgba(2, 59, 89)",
            "1":"rgba(33, 98, 132)",
            "2":"rgba(73, 132, 163)"
        };
        javgemThemes={
            "0":"rgba(48, 122, 100)",
            "1":"rgba(91, 170, 147)",
            "2":"rgba(143, 210, 190)"
        };
        var obj = '';
              var stepobj = '';

        console.log(stepobj);
        console.log(obj);
        if(obj.reportProduct==='PYGEM'){
            theme=pygemThemes;
        }else if(obj.reportProduct==='JAVGEM'){
            theme=javgemThemes;
        }else{
            
        }
        obj.Suits_Details.TestCase_Details=changeFormat(obj.Suits_Details.TestCase_Details);
        var excludeHeader=["tc_run_id","steps","execution_metadata","result_file","ignore"];
var sortType="";
var lastsortHeader="";
        var exeHeaders={
            "STATUS":"status",
            "PROJECT NAME":"project_name",
            "REPORT TYPE":"report_type",
            "ENV":"env",
            "START_TIME":"s_start_time",
            "END_TIME":"s_end_time",
            "DURATION":"duration",
        };
        var infraHeaders={
            "EXECUTED BY":"user",
            "EXECUTED ON":"machine",
            "RUN_TYPE":"run_type",
            "RUN_MODE":"run_mode"
        };
        var options=getOptions(obj.Suits_Details.TestCase_Details);
        for(var i = 0; i < options.length; i++) {
    var opt = options[i];
    var el = document.createElement("option");
    el.textContent = opt;
    el.value = opt;
    $('#status').append(el);
}


function changeFormat(value){
for (var i = 0; i < value.length; i++) {
var keys=Object.keys(value[i]);
for(var j = 0; j < keys.length; j++) {
    if(typeof(value[i][keys[j]])!="object"){
        value[i][keys[j]]={
            value:value[i][keys[j]],
            sortValue:value[i][keys[j]]
        }
    }
}
}
return value;
}
function constructPage(){

    var infraTable=getInfraDetailsTable(obj.Suits_Details);
$('#pills-overview').append(infraTable);
var cardDetailsOverview=getCardDetails(obj.Suits_Details.Testcase_Info);
var cardDetailsTestcase=getCardDetails(obj.Suits_Details.Testcase_Info);

 $('#pills-overview').append(cardDetailsOverview);
 $('#pills-testcase').append(cardDetailsTestcase);
 var exeTable=getExecutionDetailsTable(obj.Suits_Details);
 $('#pills-overview').append(exeTable);

document.getElementById('productType').innerText=obj.reportProduct;
$("#heading").css('color',theme[0]);
$("#filterHeading").css('color',theme[0]);
$('#filtercard').hover(function(){
    var col='1px solid '+theme[0];
$(this).css('border',col);

    },
    function(){
        $(this).css('border','none')
    });
$("#clear").css('background-color',theme[2]);
if(obj.reportProduct==='PYGEM'){
$('.nav-pills').addClass('pygem');
}else if(obj.reportProduct==='JAVGEM'){
    $('.nav-pills').addClass('javgem');
}else{

}

var testcaseDetailsTable=getTestcaseDetailsTable(obj.Suits_Details.TestCase_Details);
$('#pills-testcase').append(testcaseDetailsTable);

}

function getTestcaseDetailsTable(list)
{
    var div=$('<div/>').addClass('mt-5 mx-4 container-fluid');

    var cols = [];
             
            for (var i = 0; i < list.length; i++) {
                for (var k in list[i]) {
                    if (cols.indexOf(k) === -1) {
                        // Push all keys to the array
                        if(!excludeHeader.includes(k)){
                        cols.push(k);
                        }
                    }
                }
            }
            if(!cols.includes("DURATION")){
            cols.push("DURATION");
            }
            if(!cols.includes("S.No.")){
            cols.unshift("S.No.");

            }
            // Create a table element
            var table = document.createElement("table");
            table.id="tab"
             table.className="table table-borderless table-responsive w-100 d-block d-md-table";
             table.style.boxShadow='0px 4px 8px rgba(0, 71, 136, 0.11)';
             table.style.borderRadius='4px';
            // Create table row tr element of a table
            var tr = table.insertRow(-1);
            for (var i = 0; i < cols.length; i++) {
               
                // Create the table header th element
                var theader = document.createElement("th");
                theader.style.backgroundColor =theme[2].substring(0,theme[2].length - 1)+', 0.1)';
                theader.innerHTML = cols[i];
                theader.id=cols[i]+"_tc";
                 theader.addEventListener("click",getsort,true);
                // Append columnName to the table row
                tr.appendChild(theader);
                 
            }
             
            // Adding the data to the table
            for (var i = 0; i < list.length; i++) {
                 
                // Create a new row
          if(list[i]["ignore"]!==true){
                trow = table.insertRow(-1);

                trow.setAttribute('data-toggle','collapse');
                trow.setAttribute('data-target','#accord'+i);
                trow.className='checkCollapse';
                trow.style.background='white';
                for (var j = 0; j < cols.length; j++) {
                    var cell = trow.insertCell(-1);
                    
                     var att = document.createAttribute("data-input");
                     if(cols[j].includes(" ")){
                         var v=cols[j].replace(" ","_");
                 att.value = v;
               }else{
                     att.value = cols[j];
               }
                     cell.setAttributeNode(att);
                        
                     
                     if(cols[j]==='status'){
                        // cell.innerHTML = list[i][cols[j]];
                        var link=document.createElement("div");
                        link.className="btn-sm";
                        link.innerHTML=list[i][cols[j]]['value'];
                        cell.appendChild(link);
                        if(list[i][cols[j]]['value']==='PASS'){
                        link.className="statusColorPass";
                        }else if(list[i][cols[j]]['value']==='FAIL'){
                            link.className="statusColorFail";
                        }
                        else if(list[i][cols[j]]['value']==='INFO'){
                            link.className="statusColorInfo";
                        }
                        else if(list[i][cols[j]]['value']==='WARN'){
                            link.className="statusColorWarn";
                        }
                        else if(list[i][cols[j]]['value']==='INCOMPLETE'){
                            link.className="statusColorIncomplete";
                        }
                        else{
                            link.className="statusColorOthers";
                        }
                        // link.style.width='fit-content';
                    }
                    else if(cols[j].toUpperCase().includes('TIME')){
                            cell.innerHTML =changeTime(list[i][cols[j]]['value']);
                        }  else if(cols[j].includes('S.No.')){
                            cell.innerHTML =changeSerial(i)['value'];
                        }
                        else if(cols[j].toUpperCase().includes('DURATION')){
                            
                            cell.innerHTML =getDuration(list[i]['start_time']['value'],list[i]['end_time']['value'],i)['value'];
                        } else if(cols[j].toUpperCase().includes('LOG_FILE')){
                            
                            if(!list[i][cols[j]]){
                                cell.innerHTML ='None';
                                
                            }else{
                            var link=document.createElement('a');
                            link.href=list[i][cols[j]]['value'];
                            link.target="_blank";
                            link.innerHTML='View';
                            link.addEventListener('click',function(e){
                                e.stopImmediatePropagation();
                            });
                            cell.appendChild(link);
                            }
                        }
                    else{
                    cell.innerHTML = list[i][cols[j]]['value'];
                    }

                }
            }
            trowAccor=table.insertRow(-1);
            tcellAccord=trowAccor.insertCell(-1);
            tcellAccord.className='hiddenRow';
            tcellAccord.setAttribute('colspan',cols.length);
            var accordDiv=document.createElement("div");
            accordDiv.className='accordion-body collapse';
            accordDiv.id='accord'+i;
            accordDiv.setAttribute('data-parent','#tab');
            var accordHeading=$('<div/>').html('Test Step Report').addClass('mb-2 accordHeading mt-4 text-center').css('color', theme[0]);
            accordDiv.append(accordHeading[0]);
            var stepCard=createAccordionCards(stepobj[list[i]['tc_run_id']['value']].metaData[2],i);
            stepCard.addClass('mt-4');
            accordDiv.append(stepCard[0]);
            var stepDetails=createAccordionMetaDetails(stepobj[list[i]['tc_run_id']['value']].metaData);
            accordDiv.append(stepDetails[0]);
            var tableAccord=createAccordionTable(stepobj[list[i]['tc_run_id']['value']].steps,i);
            accordDiv.append(tableAccord[0]);
            tcellAccord.append(accordDiv);
           
      

            }
             
div.append(table);
return div;

}
function createAccordionTable(list,index){
    var div=$('<div/>').addClass('mt-5 mx-5 mb-2');

var cols = [];
        for (var i = 0; i < list.length; i++) {
            for (var k in list[i]) {
                if (cols.indexOf(k) === -1) {
                    // Push all keys to the array
                    if(!excludeHeader.includes(k)){
                    cols.push(k);
                    }
                }
            }
        }
        if(!cols.includes("S.No.")){
            cols.unshift("S.No.");

            }

        var table = document.createElement("table");
            table.id="tabAccord"+index;
             table.className="table table-borderless table-responsive d-block d-md-table w-100";
            //  table.style.width="100%";
             table.style.boxShadow='0px 4px 8px rgba(0, 71, 136, 0.11)';
             table.style.borderRadius='4px';
            // Create table row tr element of a table
            var tr = table.insertRow(-1);
            for (var i = 0; i < cols.length; i++) {
               
                // Create the table header th element
                var theader = document.createElement("th");
                theader.style.backgroundColor =theme[2].substring(0,theme[2].length - 1)+', 0.1)';
                theader.innerHTML = cols[i];
                theader.id=cols[i]+"_tcaccord";
                 if(cols[i]==='STATUS' || cols[i]==='status'){
                     theader.style.width='130px';
                 }
                // Append columnName to the table row
                tr.appendChild(theader);
                 
            }
            for (var i = 0; i < list.length; i++) {
                 
                 // Create a new row
                 trow = table.insertRow(-1);

            trow.style.backgroundColor ='#FFFFFF';
                 for (var j = 0; j < cols.length; j++) {
                     var cell = trow.insertCell(-1);
                      var att = document.createAttribute("data-input");
                      if(cols[j].includes(" ")){
                          var v=cols[j].replace(" ","_");
                  att.value = v;
                }else{
                      att.value = cols[j];
                }
                      cell.setAttributeNode(att);
 
                     if(typeof(list[i][cols[j]])==='object'){
                         var a=document.createElement("a");
                         a.href=list[i][cols[j]]['href'];
                         a.target="_blank";
                         a.innerHTML=list[i][cols[j]]['LinkName'];
                         cell.appendChild(a);
                     } else if(cols[j]==='STATUS' || cols[j]==='status'){
                         var cont=document.createElement("div");
                         
                         if(list[i][cols[j]]==='PASS'){
                        cont.className="statusColorPass statusAccord ";
                        }else if(list[i][cols[j]]==='FAIL'){
                            cont.className="statusColorFail statusAccord";
                        }
                        else if(list[i][cols[j]]==='INFO'){
                            cont.className="statusColorInfo statusAccord";
                        }
                        else if(list[i][cols[j]]==='WARN'){
                            cont.className="statusColorWarn statusAccord";
                        }
                        else if(list[i][cols[j]]==='INCOMPLETE'){
                            cont.className="statusColorIncomplete statusAccord";
                        }
                        else{
                            cont.className="statusColorOthers statusAccord";
                        }
                        cont.innerText = list[i][cols[j]];
                        cell.appendChild(cont);
                       
                     }
                     else if(cols[j]==='TIME' || cols[j]==='time'){
                             cell.innerHTML =convertIntoDateTime(list[i][cols[j]]);
                         }else if(cols[j]==="S.No."){
                             cell.innerHTML =i+1;
                         }
                     else{
                         if(list[i][cols[j]]===undefined){
                             list[i][cols[j]]='-';
                         }
                     cell.innerHTML = list[i][cols[j]];
                     }
                 }
             }
             div.append(table);
        return div;
}

function getExecutionDetailsTable(data){
    var div=$('<div/>').addClass(' mx-5 mt-5');
    var exeHeading= $('<span/>').html('Execution Details').addClass('tableHeading mb-2').css('color', theme[0]);
    $(div).append(exeHeading);
    var table=$('<table/>').addClass('table table-borderless table-responsive w-100 d-block d-md-table').css('box-shadow',' 0px 3px 6px rgba(0, 71, 136, 0.05)').css('border-radius','4px');
    var cols = Headers(exeHeaders);
    var headers = $('<tr>');
    var content=$('<tr/>') ;
    for (var colIndex = 0; colIndex < cols.length; colIndex++)
    {
        
           var val = data[cols[colIndex]];
           var backOpacity=theme[2].substring(0,theme[2].length-1)+', 0.1)';
            headers.append($('<th/>').html(cols[colIndex])).css('color','black').css('background-color',backOpacity);
    
               $(table).append(headers);
       }
       for (var colIndex = 0; colIndex < cols.length; colIndex++)
    {
           var val = data[exeHeaders[cols[colIndex]]];
           if(val===undefined){
               val='None';
           }
           if(cols[colIndex].toUpperCase().includes('TIME')){
val=changeTime(data[exeHeaders[cols[colIndex]]]);
           }
           if(cols[colIndex].toUpperCase().includes('DURATION')){
               val=getDuration(data[exeHeaders['START_TIME']],data[exeHeaders['END_TIME']],colIndex+'_col')['value'];
            
           }
           
           content.append($('<td/>').html(val).css('background-color','white'));
    
               $(table).append(content);
       }
       
    div.append(table);
    return div;
}

function createAccordionMetaDetails(data) {
    var div=$('<div/>').addClass('mt-4 mx-5 card p-3').css('box-shadow','0px 3px 6px rgba(0, 0, 0, 0.05)').css('border-radius','6px').css('display','block').hover(function(){
            var col='1px solid '+theme[0];
$(this).css('border',col).css('cursor','pointer');

    },
    function(){
        $(this).css('border','none')
    });
    var table=$('<table/>').addClass('table table-borderless table-responsive w-100 d-block d-md-table');
    for(var m=0;m<data.length-1;m++)
    {
 
    var headers = $('<tr>');
    var content=$('<tr/>') ;
    var cols = Headers(data[m]);
    for (var colIndex = 0; colIndex < cols.length; colIndex++)
    {
           var val = data[m][cols[colIndex]];
          
            headers.append($('<th/>').html(cols[colIndex])).css('color',theme[0]).css('max-width','3px');
           
               $(table).append(headers);
       }

       for (var colIndex = 0; colIndex < cols.length; colIndex++)
    {
           var val = data[m][cols[colIndex]];
           if(val===undefined){
               val='None';
           }
        if(val.type){

 content.append($('<td/>').html(changeDate(val)));
        }else{
           content.append($('<td/>').html(val));
        }
               $(table).append(content);
       }

    }

div.append(table);
    return div;
}

function getInfraDetailsTable(data){
    var div=$('<div/>').addClass('mt-4 mx-5 card p-3').css('box-shadow','0px 3px 6px rgba(0, 0, 0, 0.05)').css('border-radius','6px').css('display','block').hover(function(){
            var col='1px solid '+theme[0];
$(this).css('border',col).css('cursor','pointer');

    },
    function(){
        $(this).css('border','none')
    });
    
    var infraHeading= $('<span/>').html('Infra Details').addClass('tableHeading mb-2 ml-2');
     infraHeading.css('color',theme[0]);
    $(div).append(infraHeading);
    var table=$('<table/>').addClass('table table-borderless table-responsive w-100 d-block d-md-table');
    var cols = Headers(infraHeaders); 
    var headers = $('<tr>');
    var content=$('<tr/>') ;
    for (var colIndex = 0; colIndex < cols.length; colIndex++)
    {
        
           var val = data[cols[colIndex]];
          
            headers.append($('<th/>').html(cols[colIndex])).css('color',theme[0]);
           
               $(table).append(headers);
       }

       for (var colIndex = 0; colIndex < cols.length; colIndex++)
    {
           var val = data[infraHeaders[cols[colIndex]]];
           if(val===undefined){
               val='None';
           }
        
           content.append($('<td/>').html(val));
    
               $(table).append(content);
       }
       

    div.append(table);
    return div; 
}

function createAccordionCards(val,index){

var cards=Object.keys(val);
    var dummy_card=new Set();
    dummy_card.add('TOTAL');
    dummy_card.add('PASS');
    dummy_card.add('FAIL');
cards.forEach(ele=>{
    dummy_card.add(ele);
})
    cards=Array.from(dummy_card);

    var div=$('<div/>').addClass('mx-4 mt-4');
    var flex=$('<div/>').addClass('d-flex flex-wrap justify-content-start');
    for(var i=0;i<cards.length;i++){
        var card=$('<div/>').addClass('card mx-4 mt-2').css('height','92px').css('width','170px').css('box-shadow','0px 3px 6px rgba(0, 0, 0, 0.05)').css('border-radius','6px').hover(function(){
            var col='1px solid '+theme[0];
$(this).css('border',col).css('cursor','pointer');

    },
    function(){
        $(this).css('border','none')
    });
       
        var cardBody=$('<div/>').addClass('card-body').css('align-self','flex-start');
        var cardTitle=$('<span/>').addClass('title-card').css('color',theme[0])
        // if(data[cards[i]]){
        cardTitle.html(cards[i]);
//         }else{
// cardTitle.html(0);
//         }
        var cardText=$('<span/>').addClass('text-card');
         if(val[cards[i]]){
             cardText.html(val[cards[i]]);
         }
         else{
cardText.html(0);
         }
         if(cards[i]==='PASS'){
            cardText.addClass('passTest')
        }else if(cards[i]==='FAIL'){
cardText.addClass('failTest')
        }
        else if(cards[i]==='WARN'){
cardText.addClass('warnTest');
        }
        else if(cards[i]==='INFO'){
cardText.addClass('infoTest');
        } 
        else if(cards[i]==='INCOMPLETE'){
cardText.addClass('incompleteTest');
        }
        else if(cards[i]==='TOTAL'){
            cardText.css('color',theme[0]);
        }
        else{
            cardText.addClass('othersTest');
        }
        cardBody.append(cardTitle).append('<br/>').append(cardText);
        card.append(cardBody);
      
        flex.append(card);
        card.click(function(event){
           filterTable(event.currentTarget.firstChild.firstChild.innerText,index,event.currentTarget.firstChild.lastChild.innerText);
        })
    
    }

    div.append(flex);
    return div;

}
function filterTable(val,index,check){
    if(check>0){
    var $filterableRows = $('#tabAccord'+index).find('tbody').find('tr').not(':first');
    $filterableRows.hide().filter(function() {
  	return $(this).filter(function() {
      var tdText = $(this).find('.statusAccord').text().toLowerCase();
      console.log(tdText.includes(val.toLowerCase()));
             
              if(val ==='TOTAL'){
                  val ="";
              }
              if(val===undefined){
                  val ="";
              }
              else{
                  val = val.toLowerCase();
              }

    	return tdText.includes(val) ;

    }).length === $(this).length;
  }).show();
}
}

function getCardDetails(data){
    var cards=Object.keys(data);
    var dummy_card=new Set();
    dummy_card.add('TOTAL');
    dummy_card.add('PASS');
    dummy_card.add('FAIL');
cards.forEach(ele=>{
    dummy_card.add(ele);
})
    cards=Array.from(dummy_card);
   
    var cardValues=Object.values(data);
    var div=$('<div/>').addClass('col-12 mx-2 mt-4');
    var flex=$('<div/>').addClass('d-flex flex-wrap justify-content-start');
    for(var i=0;i<cards.length;i++){
        var card=$('<div/>').addClass('card mx-4 mt-2').css('height','92px').css('width','170px').css('box-shadow','0px 3px 6px rgba(0, 0, 0, 0.05)').css('border-radius','6px').hover(function(){
            var col='1px solid '+theme[0];
$(this).css('border',col).css('cursor','pointer');

    },
    function(){
        $(this).css('border','none')
    });
       
        var cardBody=$('<div/>').addClass('card-body');
        var cardTitle=$('<span/>').addClass('title-card').css('color',theme[0])
        // if(data[cards[i]]){
        cardTitle.html(cards[i]);
//         }else{
// cardTitle.html(0);
//         }
        var cardText=$('<span/>').addClass('text-card');
         if(data[cards[i]]){
             cardText.html(data[cards[i]]);
         }
         else{
cardText.html(0);
         }
         if(cards[i]==='PASS'){
            cardText.addClass('passTest')
        }else if(cards[i]==='FAIL'){
cardText.addClass('failTest')
        }
        else if(cards[i]==='WARN'){
cardText.addClass('warnTest');
        }
        else if(cards[i]==='INFO'){
cardText.addClass('infoTest');
        } 
        else if(cards[i]==='INCOMPLETE'){
cardText.addClass('incompleteTest');
        }
        else if(cards[i]==='TOTAL'){
            cardText.css('color',theme[0]);
        }
        else{
            cardText.addClass('othersTest');
        }
        cardBody.append(cardTitle).append('<br/>').append(cardText);
        card.append(cardBody);
      
        flex.append(card);
    }
div.append(flex);
    return div;
}

function changeSerial(val)
{
var serialobj={
    "value": val+1,
    "sortValue":val+1 
}
return serialobj;
}

function changeTime(val){
    var data =new Date(val);
    return data.toLocaleString();
}


function getDuration(start,end,index){
   

var startTime=new Date(start).getTime();
var endTime=new Date(end).getTime();
var dur=(endTime-startTime)/1000;
var objans={
        "value":ans,
        "sortValue":dur
    }
if(dur<60){
   objans.value= dur+" sec(s)";
}
else if(dur>=60 && dur<3600){
    var ans=Math.floor(dur/60)+" min ";
    if(Math.floor(dur%60)!==0){
 ans=ans+ Math.floor(dur%60)+" sec(s)";
    } 
    objans.value= ans;
}else if(dur>=60 && dur<86400){
    var ans=Math.floor(dur/3600)+ " hour ";
    if(Math.floor((dur%3600)/60)!==0){
        ans=ans+Math.floor((dur%3600)/60)+" min";
    }
    if(Math.floor((dur%3600)%60)!==0){
    ans=ans+ Math.floor((dur%3600)%60)+" sec(s)";
    }
    
   
     objans.value=ans;
}
if(!isNaN(index)){
    obj.Suits_Details.TestCase_Details[index]['DURATION']=objans;
    }
return objans;
}

function getOptions(val){
var options=new Set();
options.add('All');
for(var i=0;i<val.length; i++){
    options.add(val[i]["status"]['value']);
}
return Array.from(options);
}



function getsort(val){
    if(val.target.className==='fa fa-angle-up ml-1' || val.target.className==='fa fa-angle-down ml-1'){
        if(lastsortHeader===""){
    lastsortHeader=val.target.id;
    sortType="asc";
    }else if(val.target.id===lastsortHeader){
        if(sortType==="asc"){
            sortType="desc";
        }
        else{
            sortType="asc";
        }
        lastsortHeader=val.target.id;

    }else{
        sortType="asc";
        lastsortHeader=val.target.id;

    }
    var tab=[...obj.Suits_Details.TestCase_Details];
    if(sortType==="asc"){
        for(var i =0;i<tab.length;i++){
        for(var j= i+1;j<tab.length;j++){
         
            if(tab[i][val.target.id]['sortValue']>tab[j][val.target.id]['sortValue']){
                var swap = tab[i];
                tab[i] = tab[j];
                tab[j] = swap;
            }
        }
    }
}else{
    for(var i =0;i<tab.length;i++){
        for(var j= i+1;j<tab.length;j++){
            
            if(tab[i][val.target.id]['sortValue']<tab[j][val.target.id]['sortValue']){
                var swap = tab[i];
                tab[i] = tab[j];
                tab[j] = swap;
            }
        }
    } 
}
obj.Suits_Details.TestCase_Details=tab;
$('#pills-testcase').children("div")[2].remove();
var testcaseDetailsTable=getTestcaseDetailsTable(tab);
$('#pills-testcase').append(testcaseDetailsTable);
myFunction();
var icon=$('<i/>').addClass('fa').css('font-size','18px');
if(sortType==="asc"){
    icon.addClass("fa-angle-up ml-1").css('vertical-align', 'middle');
}
if(sortType==="desc"){
    icon.addClass("fa-angle-down ml-1").css('vertical-align', 'middle');
}
icon.attr("id",lastsortHeader);
var targetId="#"+lastsortHeader+"_tc";

// icon.addEventListener("click",(e)=>{
// e.stopPropagation();
// });
$(targetId).append(icon);

var $filterableRows = $('#tab').find('tbody').find('tr').not(':first');

    }else{
    if(lastsortHeader===""){
    lastsortHeader=val.target.innerText;
    sortType="asc";
    }else if(val.target.innerText===lastsortHeader){
        if(sortType==="asc"){
            sortType="desc";
        }
        else{
            sortType="asc";
        }
        lastsortHeader=val.target.innerText;

    }else{
        sortType="asc";
        lastsortHeader=val.target.innerText;

    }
    var tab=[...obj.Suits_Details.TestCase_Details];
    if(sortType==="asc"){
        for(var i =0;i<tab.length;i++){
        for(var j= i+1;j<tab.length;j++){
         
            if(tab[i][val.target.innerText]['sortValue']>tab[j][val.target.innerText]['sortValue']){
                var swap = tab[i];
                tab[i] = tab[j];
                tab[j] = swap;
            }
        }
    }
}else{
    for(var i =0;i<tab.length;i++){
        for(var j= i+1;j<tab.length;j++){
            
            if(tab[i][val.target.innerText]['sortValue']<tab[j][val.target.innerText]['sortValue']){
                var swap = tab[i];
                tab[i] = tab[j];
                tab[j] = swap;
            }
        }
    } 
}
obj.Suits_Details.TestCase_Details=tab;
$('#pills-testcase').children("div")[2].remove();
var testcaseDetailsTable=getTestcaseDetailsTable(tab);
$('#pills-testcase').append(testcaseDetailsTable);
myFunction();
var icon=$('<i/>').addClass('fa').css('font-size','18px');
if(sortType==="asc"){
    icon.addClass("fa-angle-up ml-1").css('vertical-align', 'middle');
}
if(sortType==="desc"){
    icon.addClass("fa-angle-down ml-1").css('vertical-align', 'middle');
}
icon.attr("id",lastsortHeader);
var targetId="#"+lastsortHeader+"_tc";

// icon.addEventListener("click",(e)=>{
// e.stopPropagation();
// });
$(targetId).append(icon);

var $filterableRows = $('#tab').find('tbody').find('tr').not(':first');
    }
}

function clickFunc(event){
event.stopPropagation();
}
function Headers(list) {
            var columns = [];
           row=list
                for (var k in row) {
                    if ($.inArray(k, columns) == -1) {
                        columns.push(k);
                    }
                }
                return columns;
        }   



        var eventList = ["change", "load","click"];
        for(event of eventList){
        window.addEventListener(event, function () {
          
            var $filterableRows = $('#tab').find('tbody').find('tr').not(':first'),
		$inputs = $('.search-key');
$inputs.live('input', function() {
getTestcaseDetailsTable(obj.Suits_Details.TestCase_Details);
	$filterableRows.hide().filter(function() {
  	return $(this).find('td').filter(function() {
      var tdText = $(this).text().toLowerCase(),
      		inputValue = $('#' + $(this).data('input')).val();
             
              if(inputValue ==='All'){
                  inputValue ="";
              }
              if(inputValue===undefined){
                  inputValue ="";
              }
              else{
                  inputValue = inputValue.toLowerCase();
              }
    	return tdText.indexOf(inputValue) != -1;
  
    }).length == $(this).find('td').length;
  }).show();

});
        });
    }
    
function showFilterCards(val){
    if(val ==='show'){
           $('#filtercard').css('display', 'block');
       }else{        
        $('#filtercard').css('display', 'none'); 
       }
}

    function showFilter(val){
       if(val !=='overview'){
           $('#filters').css('display', 'block');
       }else{        
        $('#filters').css('display', 'none'); 
       }
   }

function myFunction(){
   var inputs=$('.search-key');
   for(var i=0;i<inputs.length;i++){
       if(inputs[i].id==='status'){
           inputs[i].value='All';
       }else{
       inputs[i].value='';
       }
   }


    var $filterableRows = $('#tab tbody tr');
   $filterableRows.show()
}

function openDialog() {
     $('a[name=Test]').on('click', function(e){
         e.preventDefault();
         $('#modal').load(this.href).dialog({ modal : true });
  });
}

function changeDate(val){
    var temp=val.type.toLowerCase();
    var d= new Date(val.value);
    if(temp==='date'){
        
        return d.toLocaleDateString();
    }else if(temp==='time'){
        return d.toLocaleTimeString();
    }else if(temp==='datetime'){
return d.toLocaleString();
    }
}

function convertIntoDateTime(value){
 var date = new Date(value);
 return date.toLocaleString();
        }   



</script>
</html>